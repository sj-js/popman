function PopMan(){var t=this;this.popMap={},this.darkList=[],this.focusDarkMap={},this.divCamSizeChecker,window.addEventListener("resize",function(e){for(var n in t.popMap)t.isOn(n)&&t.adjustPossition(n)})}window.getNewEl=function(t,e,n,i,o,r,s){var a=document.createElement(t);e&&(a.id=e),n&&a.setAttribute("class",n);for(var l in i)a.setAttribute(l,i[l]);return o&&(a.innerHTML=o),r&&getEl(a).addEventListener(r,function(t){s(t)}),a},window.getEl=function(t){var e="object"==typeof t?t:document.getElementById(t);return this.obj=e,this.attr=function(t,n){return n?(e.setAttribute(t,n),this):e.getAttribute(t)},this.clas=function(){var t={has:function(t){return e.className.indexOf(t)!=-1},add:function(n){return e.classList?e.classList.add(n):e.className+=" "+n+" ",t},remove:function(n){if(e.classList)e.classList.remove(n);else{for(var i=e.className.split(" ");i.indexOf(n)!=-1;)i.splice(i.indexOf(n),1);e.className=i.join(" ")}return t}};return t}(),this.add=function(t){return"object"==typeof t?e.appendChild(t):e.innerHTML+=t,this},this.addln=function(t){return"object"==typeof t?e.appendChild(t):e.innerHTML+=t?t:"",e.appendChild(document.createElement("br")),this},this.hasEventListener=function(t){return e.hasEventListener(t)},this.removeEventListener=function(t,n){return e.removeEventListener(t,n),this},this.addEventListener=function(t,n){navigator.userAgent.indexOf("Firefox")!=-1&&e.addEventListener(t,function(t){window.event=t},!0),e.addEventListener?e.addEventListener(t,function(t){n(t)}):e.attachEvent("on"+t,function(t){!t.target&&t.srcElement&&(t.target=t.srcElement),n(t)})},this.del=function(t){return e.removeChild(t),this},this.html=function(t){return e.innerHTML=t,this},this.clear=function(){return e.innerHTML="",this},this.scrollDown=function(){return e.scrollTop=e.scrollHeight,this},this.disableSelection=function(){return"undefined"!=typeof e.ondragstart&&(e.ondragstart=function(){return!1}),"undefined"!=typeof e.onselectstart&&(e.onselectstart=function(){return!1}),"undefined"!=typeof e.oncontextmenu&&(e.oncontextmenu=function(){return!1}),"undefined"!=typeof e.style.MozUserSelect&&(document.body.style.MozUserSelect="none"),this},this.hideDiv=function(){return e.style.display="block",e.style.position="absolute",e.style.left="-5555px",e.style.top="-5555px",this},this.showDiv=function(){return e.style.display="block",e.style.position="absolute",e.style.left="0px",e.style.top="0px",this},this.getNewSeqId=function(t){for(var n=1;n<5e4;n++){var i=t+n;if(!(i in e))return i}return null},this.isAccepted=function(t,e){var n=!1;return t?this.find(t)&&(n=!0):n=!0,e&&this.find(e)&&(n=!1),n},this.find=function(t){if(e instanceof Array){for(var n=[],i=0;i<e.length;i++){var o=this.getMatchedObjWithParam(e[i],t);o&&n.push(o)}return n}if(e instanceof Object){var o=this.getMatchedObjWithParam(e,t);return o}},this.getMatchedObjWithParam=function(t,e){if("string"==typeof e&&(e={id:e}),e instanceof Array){for(var n=0;n<e.length;n++)if(this.find(e[n]))return t}else if(e instanceof Object){for(var i=Object.keys(e),n=0;n<i.length;n++){var o=i[n];if(!t[o]||t[o]!=e[o])return}return t}},this.findDomDataAttribute=function(t){if(e instanceof Array){for(var n=[],i=0;i<e.length;i++){var o=this.getMatchedDomWithParam(e[i],t);o&&n.push(o)}return n}if(e instanceof Object){var o=this.getMatchedDomWithParam(e,t);return o}},this.getMatchedDomWithParam=function(t,e){if("string"==typeof e&&(e={id:e}),e instanceof Array){for(var n=0;n<e.length;n++)if(this.findDomDataAttribute(e[n]))return t}else if(e instanceof Object){for(var i=Object.keys(e),o="data-",n=0;n<i.length;n++){var r=i[n];if(!t.getAttribute(o+r)||t.getAttribute(o+r)!=e[r])return}return t}},this.getParentEl=function(t){for(var n=e;n&&void 0==n.getAttribute(t);)n=n.parentNode;return n},this.findEl=function(t,n){for(var i=e.children,o=0;o<i.length;o++)if(i[o].getAttribute(t)==n)return i[o]},this.findParentEl=function(t,n){for(var i,o=e;o;){if(o==document.body.parentNode){i=null;break}if(o.getAttribute(t)==n){i=o;break}o=o.parentNode}return i},this},window.getData=function(t){var t=t;return this.parse=function(){if(t){var e=t.substr(0,1),n=t.substr(t.length-1,1);if("string"==typeof t){if("{"==e&&"}"==n)return JSON.parse(t);if("["==e&&"]"==n)return JSON.parse(t);if(t.indexOf(",")!=-1){for(var i=t.split(","),o=0;o<i.length;o++)i[o]=i[o].trim();return i}}return t}},this},function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var i=(new Date).getTime(),o=Math.max(0,16-(i-t)),r=window.setTimeout(function(){e(i+o)},o);return t=i+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){window.URL=window.URL||window.webkitURL,window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder}(),function(){navigator.userAgent.indexOf("Firefox")!=-1&&window.addEventListener(eventNm,function(t){window.event=t},!0),!window.addEventListener&&window.attachEvent&&(window.addEventListener=function(t,e){window.attachEvent("on"+t,function(t){!t.target&&t.srcElement&&(t.target=t.srcElement),t.preventDefault||(t.preventDefault=function(){}),t.stopPropagation||(t.stopPropagation=function(){t.returnValue=!1,t.cancelBubble=!0}),e(t)})})}(),function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]==t)return e;return-1})}(),function(){document.querySelectorAll||document.getElementsByTagName&&(document.querySelectorAll=function(){var t,e=selector.indexOf("["),n=selector.indexOf("]"),i=[];if(e!=-1&&n!=-1){t=selector.substring(e+1,n);for(var o=["div","span","form","input","select","textarea"],r=0;r<o.length;r++)for(var s=document.getElementsByTagName(o[r]),a=0;a<s.length;a++)void 0!=s[a].getAttribute(t)&&i.push(s[a])}return i})}(),function(){window.getComputedStyle||(window.getComputedStyle=function(t){return t.currentStyle})}(),function(){JSON||(JSON.stringify=JSON.stringify||function(t){var e=typeof t;if("object"!=e||null===t)return"string"==e&&(t='"'+t+'"'),String(t);var n,i,o=[],r=t&&t.constructor==Array;for(n in t)i=t[n],e=typeof i,"string"==e?i='"'+i+'"':"object"==e&&null!==i&&(i=JSON.stringify(i)),o.push((r?"":'"'+n+'":')+String(i));return(r?"[":"{")+String(o)+(r?"]":"}")},JSON.parse=JSON.parse||function(str){return""===str&&(str='""'),eval("var p="+str+";"),p})}(),PopMan.prototype.detect=function(t){for(var e=sjHelper.cross.querySelectorAll("[data-pop]"),n=0;n<e.length;n++){var i=e[n],o=i.getAttribute("data-pop");this.add(o,i)}},PopMan.prototype.add=function(t){var e=t.name,n=document.createElement("div");n.style.display="inline-block",n.style.background="white",n.style.width=t.width?t.width:"100%",n.style.height=t.height?t.height:"100%",n.style.overflow="auto",getEl(n).hideDiv(),getEl(n).addEventListener("click",function(t){t.preventDefault(),t.stopPropagation()}),getEl(document.body).add(n);var i=t.add;return"function"==typeof i?i(t):"object"==typeof i&&getEl(n).add(i),this.popMap[e]=t,this.popMap[e].popEl=n,this.popMap[e].darkEl=null,this.popMap[e].isPoped=!1,this},PopMan.prototype.isOn=function(t){var e=this.popMap[t];return e&&e.isPoped},PopMan.prototype.toggle=function(t){this.isOn(t)?this.close(t):this.pop(t)},PopMan.prototype.pop=function(t,e){var n=this.popMap[t];n.isPoped||(n.pop&&n.pop(n),n.noDark?getEl(document.body).add(n.popEl):(n.darkEl=this.spreadDark(n),getEl(n.darkEl).add(n.popEl)),this.adjustPossition(t),n.isPoped=!0,e&&e())},PopMan.prototype.close=function(t,e){var n=this.popMap[t];n.isPoped&&(n.close&&n.close(n),getEl(n.popEl.parentNode).del(n.popEl),n.noDark||this.closeDark(n.darkEl),n.isPoped=!1,e&&e())},PopMan.prototype.focusOn=function(t){if(!this.focusDarkMap.up&&t){var e=t.getBoundingClientRect?t.getBoundingClientRect():this.getBodyOffset(t),n=t.ownerDocument,i=n.defaultView||n.parentWindow,o=this.getFrameOffset(i),r=e.left+o.left,s=e.top+o.top,a=t.offsetWidth,l=t.offsetHeight;if(0==a)return!1;var f=this.getDivCamSizeChecker().offsetWidth,p=this.getDivCamSizeChecker().offsetHeight;this.focusDarkMap={up:this.getDarkEl(0,0,f,s),down:this.getDarkEl(0,s+l,f,p),left:this.getDarkEl(0,s,r,s+l),right:this.getDarkEl(r+a,s,f,s+l),arrow:this.getArrow(r-30,s-9,">>>")};for(var d in this.focusDarkMap){var u=this.focusDarkMap[d];getEl(document.body).add(u),window.getComputedStyle(u).background,"arrow"!=d&&this.setBackgroundColor(u,"rgba(0,0,0,.7)")}return!0}},PopMan.prototype.focusOff=function(){for(var t in this.focusDarkMap){var e=this.focusDarkMap[t];getEl(e.parentNode).del(e),delete this.focusDarkMap[t]}},PopMan.prototype.getDivCamSizeChecker=function(){if(!this.divCamSizeChecker){var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.left="-7777px",t.style.top="-7777px",document.body.appendChild(t),this.divCamSizeChecker=t}return this.divCamSizeChecker},PopMan.prototype.spreadDark=function(t){var e=this,n=e.findHighestZIndex()+1,i="rgba(0,0,0,.7)",o=document.createElement("div");this.darkList.push(o),t.easyclose&&getEl(o).addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),e.close(t.name)}),getEl(o).showDiv(),getEl(document.body).add(o),o.style.display="block",o.style.width="100%",o.style.height="100%",o.style.zIndex=n;try{o.style.background=i}catch(r){if(i.indexOf("rgba")!=-1){i=i.replace("rgba","rgb");var s=i.lastIndexOf(",");i=i.substring(0,s)+")"}o.style.background=i}return o},PopMan.prototype.adjustPossition=function(t,e){function n(t,e){var n=(t+"").length,i=(parseFloat(t)+"").length;return i==n?result=t+e:result=t,result}var i=this.popMap[t],o=i.popEl,r=o.parentNode.offsetWidth,s=o.parentNode.offsetHeight;s=0==s?this.getDivCamSizeChecker().offsetHeight:s,o.style.position="absolute";var a=this.getSolvedPopExpMap(r,i.expx),l=this.getSolvedPopExpMap(s,i.expy);o.style.left=n(a.pos,"px"),o.style.top=n(l.pos,"px"),o.style.width=n(a.size,"px"),o.style.height=n(l.size,"px")},PopMan.prototype.getSolvedPopExpMap=function(t,e){var n,i,o,r,s,a,l,f,p,d=this.getSize;if(e){var u=e.indexOf("("),c=e.indexOf(")");p=u!=-1&&c!=-1,p?(i=e.substring(0,u),r=e.substring(c+1,e.length),o=e.substring(u+1,c)):(i="*",o=e,r="*"),s=d(t,i),a=d(t,o),l=d(t,r),"*"==o&&(a=t-s-l),f="*"==i&&"*"!=r?t-a-l:"*"!=i&&"*"==r?0:"*"==i&&"*"==r?(t-a)/2:s,n={isPopExp:p,expStart:i,expEnd:r,expSize:o,pos:f,size:a}}else n={isPopExp:!1,expStart:i,expEnd:r,expSize:o,pos:t-t/2-t/4,size:t/2};return n},PopMan.prototype.getSize=function(t,e){return"undefined"==typeof e?0:(e+"").indexOf("%")!=-1?t*(parseFloat(e)/100):(e+"").indexOf("*")!=-1?0:e},PopMan.prototype.closeDark=function(t){for(var e=this.darkList,n=0;n<e.length;n++)e[n]==t&&(e.splice(n,1),getEl(t.parentNode).del(t))},PopMan.prototype.getDarkEl=function(t,e,n,i){function o(t){return t>=0?t:0}var r=50,s=document.createElement("div"),a="px";return s.style.left=t+a,s.style.top=e+a,s.style.width=o(n-t)+a,s.style.height=o(i-e)+a,s.style.zIndex=r,s.style.display="block",s.style.position="absolute",s.style.transition="background-color .5s, transform .5s",this.setBackgroundColor(s,"rgba(255,255,255,0)"),s},PopMan.prototype.getArrow=function(t,e,n){var i=51,o=document.createElement("div"),r="px";return o.style.left=t+r,o.style.top=e+r,o.style.width="30px",o.style.height="30px",o.style.zIndex=i,o.style.display="block",o.style.position="absolute",o.style.transition="background-color .5s, transform .5s",o.style.color="white",o.innerHTML=n,o},PopMan.prototype.getBodyOffset=function(t){for(var e=0,n=0,i=t,o=t.parentNode;o;){var r=0,s=0;if(i!=document.body&&(r=i.scrollLeft,s=i.scrollTop),!o.style)break;if("absolute"==o.style.position)e+=i.offsetLeft-r,n+=i.offsetTop-s;else{if("fixed"==o.style.position||"fixed"==i.style.position){e+=i.offsetLeft+sjHelper.cross.getBodyScrollX(),n+=i.offsetTop+sjHelper.cross.getBodyScrollY();break}e+=i.offsetLeft-o.offsetLeft-r,n+=i.offsetTop-o.offsetTop-s}i=o,o=o.parentNode}var a={left:e,top:n,width:t.offsetWidth,height:t.offsetHeight};return a},PopMan.prototype.getFrameOffset=function(t,e){if(e="undefined"==typeof e?{top:0,left:0}:e,t!==top){var n=t.frameElement.getBoundingClientRect();e.left+=n.left,e.top+=n.top,e=this.getFrameOffset(t.parent,e)}return e},PopMan.prototype.setBackgroundColor=function(t,e){try{t.style.background=e}catch(n){if(e.indexOf("rgba")!=-1){e=e.replace("rgba","rgb");var i=e.lastIndexOf(",");e=e.substring(0,i)+")"}t.style.background=e}},PopMan.prototype.findHighestZIndex=function(t){var e=0;if(t?"string"==typeof t&&(t=[t]):t=["div"],t instanceof Array)for(var n=0;n<t.length;n++)for(var i=document.getElementsByTagName(t[0]),n=0;n<i.length;n++){var o=document.defaultView.getComputedStyle(i[n],null).getPropertyValue("z-index");o>e&&"auto"!=o&&(e=o)}return parseInt(e)};